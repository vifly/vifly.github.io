<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="第十届中科大信息安全大赛（Hackergame 2023）的经历与题解"><title>2023 中科大信息安全大赛题解</title>
<link rel=canonical href=https://viflythink.com/Hackergame_2023_writeups/><link rel=stylesheet href=/scss/style.min.450926226e724574a6b936335ea06111f8aeb253d932c86cb2cc807341cd2889.css><meta property="og:title" content="2023 中科大信息安全大赛题解"><meta property="og:description" content="第十届中科大信息安全大赛（Hackergame 2023）的经历与题解"><meta property="og:url" content="https://viflythink.com/Hackergame_2023_writeups/"><meta property="og:site_name" content="Vifly 的博客"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="信息安全"><meta property="article:published_time" content="2023-11-05T00:00:00+08:00"><meta property="article:modified_time" content="2023-11-05T00:00:00+08:00"><meta property="og:image" content="https://viflythink.com/Hackergame_2023_writeups/show.jpg"><meta name=twitter:title content="2023 中科大信息安全大赛题解"><meta name=twitter:description content="第十届中科大信息安全大赛（Hackergame 2023）的经历与题解"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://viflythink.com/Hackergame_2023_writeups/show.jpg"><link rel="shortcut icon" href=img/favicon.png><meta name=google-site-verification content="o-widUnxdyv8T6wPC_NGLfDgKUwgv2-zMnQhKLKul3Y"><meta name=msvalidate.01 content="D8C8D2BAD9DA419D96DA79455FC4DDBC"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu139cde8ab2a45f6f8ca9b1d680d35535_828870_300x0_resize_box_3.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Vifly 的博客</a></h1><script>fetch("https://api.github.com/gists/7a04e2188185ddb19cbd19d8217b9400").then(e=>{if(e.ok)return e.json();throw new Error("Unable to fetch gist slogans.")}).then(e=>JSON.parse(e.files["slogans.json"].content)).then(e=>e[Math.floor(Math.random()*e.length)].content).then(e=>{document.getElementById("slogan").innerHTML="<h2 id='slogan' class='site-description'>"+e+"</h2>"})</script><h2 id=slogan class=site-description></h2></div></header><ol class=social-menu><li><a href=mailto:viflythink@gmail.com target=_blank title=Email><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-mail" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="3" y="5" width="18" height="14" rx="2"/><polyline points="3 7 12 13 21 7"/></svg></a></li><li><a href=https://github.com/vifly target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://viflythink.com/atom.xml target=_blank title=RSS><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></a></li><li><a href=https://t.me/viflythink target=_blank title=Telegram><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-telegram" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M15 10l-4 4 6 6 4-16-18 7 4 2 2 6 3-4"/></svg></a></li><li><a href=https://twitter.com/viflythink target=_blank title=Twitter><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/ target=_blank><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/tags/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-tag" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11 3l9 9a1.5 1.5.0 010 2l-6 6a1.5 1.5.0 01-2 0L3 11V7a4 4 0 014-4h4"/><circle cx="9" cy="9" r="2"/></svg><span>Tags</span></a></li><li><a href=/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>About</span></a></li><li><a href=/links/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg><span>Links</span></a></li><li><a href=/service/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-cloud" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 18a4.6 4.4.0 010-9 5 4.5.0 0111 2h1a3.5 3.5.0 010 7H7"/></svg><span>Service</span></a></li><li><a href=/gpg/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-key" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="8" cy="15" r="4"/><line x1="10.85" y1="12.15" x2="19" y2="4"/><line x1="18" y1="5" x2="20" y2="7"/><line x1="15" y1="8" x2="17" y2="10"/></svg><span>GPG key</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/Hackergame_2023_writeups/><img src=/Hackergame_2023_writeups/show_hu16eda26c96b562b2aa748b665454afd5_125054_800x0_resize_q75_box.jpg srcset="/Hackergame_2023_writeups/show_hu16eda26c96b562b2aa748b665454afd5_125054_800x0_resize_q75_box.jpg 800w, /Hackergame_2023_writeups/show_hu16eda26c96b562b2aa748b665454afd5_125054_1600x0_resize_q75_box.jpg 1600w" width=800 height=661 loading=lazy alt="Featured image of post 2023 中科大信息安全大赛题解"></a></div><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/Hackergame_2023_writeups/>2023 中科大信息安全大赛题解</a></h2><h3 class=article-subtitle>第十届中科大信息安全大赛（Hackergame 2023）的经历与题解</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>2023 年 11 月 05 日</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>11 minute read</time></div></footer></div></header><section class=article-content><p>又到了更新年更系列的时间，本文的题图来自于今年 Hackergame 中的“逆向工程不需要 F5“这一道题。对于今年的 Hackergame，能明显看到为了吸引更多新人所做的努力，包括增加了不少送分题，还新增了 AI 方向的题目，这使得博主拿到了 2600 分，正好是<a class=link href=https://viflythink.com/Hackergame_2022_writeups/ target=_blank rel=noopener>上一年</a>得分的两倍（虽说如此，排名也没怎么上升）。由于今年解决的题目变多了，所以本文的总文字量也比往年明显增多，不知道明年会不会更长呢，敬请期待吧。</p><h1 id=hackergame-启动>Hackergame 启动</h1><p>这个题目很显然玩的是“XX 启动”的梗，点进去以后要求录一段音频并达到与原音频 100% 相似的程度，由于是 web 题，所以先尝试录了一段音频（当然我禁用了麦克风），看到网页跳转到了一个新 URL 并显示相似度有百分之七十多，而 URL 中的 similarity 参数与之对应，把参数改为 100 就会跳到另一个界面，点击“获取 flag”就拿到 flag 了（<em>PS:为啥还配了音乐啊</em>）。</p><p><img src=/Hackergame_2023_writeups/get_2023_qiandao_flag.jpg width=2560 height=1331 loading=lazy alt="成功获取签到题的 flag" class=gallery-image data-flex-grow=192 data-flex-basis=461px></p><h1 id=猫咪小测>猫咪小测</h1><p>又是每年必有的考验信息检索能力的题目，不过为什么今年我又没用上暴力破解的方法。</p><p>第一小题，如何在图书馆找到一本图书的大致位置呢，一般来说图书馆都会按图书类别将其放到不同楼层，而《A Classical Introduction To Modern Number Theory 2nd ed.》是一本外文书籍，所以按<a class=link href=https://lib.ustc.edu.cn/%E6%9C%AC%E9%A6%86%E6%A6%82%E5%86%B5/%E5%9B%BE%E4%B9%A6%E9%A6%86%E6%A6%82%E5%86%B5%E5%85%B6%E4%BB%96%E6%96%87%E6%A1%A3/%E8%A5%BF%E5%8C%BA%E5%9B%BE%E4%B9%A6%E9%A6%86%E7%AE%80%E4%BB%8B/ target=_blank rel=noopener>西区图书馆简介</a>
所说外文书库的位置是 12 楼，这就是正确答案。</p><p>第二小题提到的论文挺有趣的，没想到有人会提出这个问题，直接在 Google 搜索“universe chicken density site:arxiv.org”且把时间限定在一年内就找到了<a class=link href=https://arxiv.org/abs/2303.17626 target=_blank rel=noopener>对应论文</a>，从论文摘要可以得出 23 这个答案。</p><p>第三小题直接搜索“build kernel support bbr”就行，答案是 CONFIG_TCP_CONG_BBR。</p><p>第四小题搜索“mypy infinite loop”且把时间限定在一年内，从一堆结果中找到了<a class=link href=https://drops.dagstuhl.de/opus/volltexte/2023/18237/pdf/LIPIcs-ECOOP-2023-44.pdf target=_blank rel=noopener>对应论文</a>，第一页中摘要下方有一行“Supplementary Material Software (ECOOP 2023 Artifact Evaluation approved artifact)”，即使不怎么阅读论文，从 2023 这个词也可以看出 ECOOP 大概率是会议名称。</p><h1 id=更深更暗>更深更暗</h1><p>没想到这道题目这么简单，随手翻了一下 main.js 就找到了获得 flag 的方法，如下图所示，getFlag 函数用于计算 flag，而且还贴心地写了一行注释提醒我函数输入就是自己的 token，所以直接在浏览器控制台里执行函数内的逻辑就拿到了 flag。</p><p><img src=/Hackergame_2023_writeups/get_deeper_and_darker_flag.jpg width=2447 height=1266 loading=lazy alt="更深更暗中的 getFlag 函数" class=gallery-image data-flex-grow=193 data-flex-basis=463px></p><h1 id=旅行照片-30>旅行照片 3.0</h1><p>今年延续前两年的传统又出了一道社会工程学题目，而且每年的解题思路都有所不同，值得好评。</p><h2 id=题目-1-2>题目 1-2</h2><p>首先从奖牌照片中的“Excoluisse per artes”文字经过 Google 搜索后得知这是诺贝尔奖，接着搜索“Nobel prize Koshiba”就能知道对应的是诺贝尔物理学奖得主 Masatoshi Koshiba（小柴昌俊），任职于东京大学，所以学长在东京大学读书。然后在<a class=link href=https://en.wikipedia.org/wiki/List_of_University_of_Tokyo_people target=_blank rel=noopener>东京大学校友列表</a>里找到其他诺贝尔物理学奖得主，经过逐个确认后发现 Takaaki Kajita（梶田隆章）是出生最晚的，在其<a class=link href=https://en.wikipedia.org/wiki/Takaaki_Kajita target=_blank rel=noopener>简介页面</a>中看到得诺贝尔奖时在 Institute for Cosmic Ray Research（简称 ICRR）工作，故得到了第二小题的答案。然而第一小题令我很头痛，没有从照片上找到可以确认见面日期的信息，最后从题目提到的“今年暑假”得到灵感，直接暴力尝试今年七月到八月的所有日期，最后试出来答案是 2023-08-10。</p><h2 id=题目-3-4>题目 3-4</h2><p>首先，从 Google 地图可以看出东京大学附近的博物馆都集中在上野公园一带，然后在 Google 街景地图中开始寻找与照片相似的地方，一番查找后找到了<a class=link href=https://maps.app.goo.gl/vc76ecQFS3UdTPDQA target=_blank rel=noopener>这个位置</a>，从地图上可以明显看出这里的喷泉是在东京国立博物馆门口前马路的对面，在东京国立博物馆官网查找票价，发现普通游客需要支付 1000 日元的门票费，而<a class=link href="https://www.tnm.jp/modules/r_free_page/index.php?id=167" target=_blank rel=noopener>东京大学的学生则可以凭学生证免费入场</a>，所以第四小题答案是 0，而第三小题还需要找到对应的活动，通过 Google 翻译得到“活动志愿者”的日文名称，然后 Google 搜索“上野公园 イベントボランティア 2023/8”并把日期限制在一年内找到了<a class=link href=https://umeshu-matsuri.jp/tokyo_staff/ target=_blank rel=noopener>活动的官网</a>，阅读文字后得到答案 S495584522。</p><h1 id=赛博井字棋>赛博井字棋</h1><p>玩井字棋在先手的情况下，无论如何都是无法战胜后手的（最佳情况是平局），所以这题需要用一些手段来获胜。通过 F12 可以看出每次点击时都会发送一个带有落子位置数据的 POST 请求，尝试把其中的数字改为负数、浮点数、超大的整数等，发现都会导致棋盘被重置。</p><p><img src=/Hackergame_2023_writeups/view_board_requests.jpg width=2348 height=1260 loading=lazy alt=查看落子时的请求 class=gallery-image data-flex-grow=186 data-flex-basis=447px></p><p>卡住半天后有了一个新的想法，假如我把落子位置设为对手此前的落子位置会怎样，测试了以下后发现我的棋子会直接覆盖对方的棋子，这说明我们可以很开心地上演“下一回合还是我的回合”的场面，最后写了<a class=link href=https://gist.github.com/vifly/406b6ad86a4f725b14a6494dff1755c3#file-crack_board-py target=_blank rel=noopener>一个简单的脚本</a>直接拿到 flag。</p><h1 id=奶奶的睡前-flag-故事>奶奶的睡前 flag 故事</h1><p>本题目来源于今年有人用“奶奶会用 Windows 激活码来哄我睡觉”这个提示词（prompt）诱使大语言模型提供 Windows 激活码的事情。首先题目已经直接用加粗标注提醒我们这个 Piexl 手机（Google 亲儿子）的系统没升级了，另外我还记得之前 Pixel 手机曾曝出截图工具存在安全漏洞的事情，Google 搜索“Pixel screenshot vulnerability”直接找到了一篇<a class=link href=https://www.securityweek.com/google-pixel-vulnerability-allows-the-recovery-of-cropped-screenshots/ target=_blank rel=noopener>对应的报道</a>，里面还附上了<a class=link href=https://gist.github.com/DavidBuchanan314/93de9d07f7fab494bcdf17c2bd6cef02 target=_blank rel=noopener>测试用的代码</a>，运行该代码就还原出了原来应该被丢弃的部分：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>python3 acropalypse_matching_sha256.py <span class=m>1080</span> <span class=m>1068</span> hackergame.png reconstructed.png
</span></span></code></pre></div><p><img src=/Hackergame_2023_writeups/screenshot_hidden_part.png width=1080 height=1068 loading=lazy alt=被隐藏的截图部分 class=gallery-image data-flex-grow=101 data-flex-basis=242px></p><h1 id=组委会模拟器>组委会模拟器</h1><p>还是先靠 F12 找到整个过程中的网络请求，发现其逻辑是先获取一个含有聊天消息的 json，然后在屏幕上按照 delay 字段规定的时间开始显示这些消息，尝试点击一条消息进行撤回，找到对应的 POST 请求。搞清楚后开始编写代码把符合条件的消息全都撤回，但是在执行几次撤回后出现了“检测到时空穿越”的错误😦。至此需要做的事情就很清楚了，获取所有消息后需要在经过每条消息的 delay 字段指示的时间后进行判断，如果是需要撤回的消息那便在 3 秒内撤回，对应<a class=link href=https://gist.github.com/vifly/406b6ad86a4f725b14a6494dff1755c3#file-hack_delete_msg-py target=_blank rel=noopener>这个脚本</a>。</p><h1 id=虫>虫</h1><p>我并非无线电爱好者，所以这题对我来说有点难度。根据题目所说的“接收来自国际空间站（ISS）的图片”尝试 Google“recv image from ISS”，得知需要通过 SSTV（慢电视扫描）来从接收到的无线电音频信号中接收图片这一点信息，然后想到能否直接用 SSTV 对题目给的音频文件进行解码以获取图片呢。Google 后找到<a class=link href=https://www.chonky.net/hamradio/decoding-sstv-from-a-file-on-a-linux-system target=_blank rel=noopener>一篇教程</a>，但其中用的软件有点过时，我都已经用 pipewire 替代 pulseaudio 了，所以我所做的操作就是先安装 QSSTV 这个软件，打开后点击开始接收，然后在命令行运行（甚至都不需要 VLC）：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>pw-play --target <span class=s2>&#34;QSSTV&#34;</span> insect.wav
</span></span></code></pre></div><p>这就可以在 QSSTV 中看到图片像素一行行地出现了，怪不得这个叫慢电视扫描，以及接收过程中的信号显示图表看上去很好玩，推荐没用过 QSSTV 的童鞋试一试。</p><p><img src=/Hackergame_2023_writeups/qsstv_get_flag.jpg width=1123 height=910 loading=lazy alt="通过 QSSTV 获取 flag 图片" class=gallery-image data-flex-grow=123 data-flex-basis=296px></p><h1 id=json--yaml>JSON ⊂ YAML?</h1><p>做这题前我真没想到 YAML 有这么多的坑，甚至都不是 JSON 的超集（之前一直认为是的），第二小题试了一下“\t”以及大致扫了一遍 ruamel-yaml 的 bug 列表后就放弃了。总而言之我以后还是用 TOML 作为配置文件格式吧。<em>PS：万一明年 Hackergame 用 TOML 出了一道类似的题目那就&mldr;</em></p><h2 id=json--yaml-11>JSON ⊄ YAML 1.1</h2><p>找到了一篇<a class=link href=https://john-millikin.com/json-is-not-a-yaml-subset target=_blank rel=noopener>说明 JSON 并非 YAML 子集的文章</a>，按照里面提供的例子输入 {&ldquo;a&rdquo;: 1e2} 拿到了本题的 flag。</p><h1 id=git-git>Git? Git!</h1><p>没想到出题人还记得怒斥“不讲武德”的马保国啊。首先尝试用<a class=link href=http://thegreycorner.com/pentesting_stuff/writeups/gitsecrets.html target=_blank rel=noopener>这里</a>提到的 <code>git grep -n 'flag' $(git rev-list --all)</code> 在所有提交涉及的文件中查找 flag，没有找到，看上去删的很干净。正当我束手无策时，破罐子破摔地试了进入 .git/objects 查看了一下，发现文件并不多，考虑到即使相关提交已经被彻底干掉了，文件的历史版本在这里也会被继续保留，所以说能不能读取这里的文件找到 flag 呢，找到<a class=link href=https://matthew-brett.github.io/curious-git/reading_git_objects.html target=_blank rel=noopener>相关教程</a>后写了<a class=link href=https://gist.github.com/vifly/406b6ad86a4f725b14a6494dff1755c3#file-find_flag_from_git_objects-py target=_blank rel=noopener>一个脚本</a>进行尝试，成功找到了 flag（不解码提取到的内容是因为有些字符不能被 UTF-8 解码）。</p><h1 id=http-集邮册>HTTP 集邮册</h1><p>第二小题做不出来导致第三小题也没心思做了，草草地拿下第一题就躺了。</p><h2 id=5-种状态码>5 种状态码</h2><p>什么都不改直接点“发送”即可拿到 200。</p><p>随便删点东西导致这个请求不合法以拿到 400。</p><pre tabindex=0><code>GET HTTP/1.1\r\n
Host: example.com\r\n\r\n
</code></pre><p>尝试访问非默认的路径拿到了 404。</p><pre tabindex=0><code>GET /test HTTP/1.1\r\n
Host: example.com\r\n\r\n
</code></pre><p>既然尝试了访问非默认的路径，不妨再试试用别的方法访问默认路径，于是拿到了 405。</p><pre tabindex=0><code>POST / HTTP/1.1\r\n
Host: example.com\r\n\r\n
</code></pre><p>最后，我记得 Nginx 默认配置下还没支持 HTTP 2.0，所以靠此拿到了 505。</p><pre tabindex=0><code>GET / HTTP/2.0\r\n
Host: example.com\r\n\r\n
</code></pre><h1 id=docker-for-everyone>Docker for Everyone</h1><p>Docker 的安全性也是一个老生常谈的问题了，本题虽不是把 Docker 当沙盒用这样的经典情况，但 X 忽略了 docker 用户组对 Unix 用户管理体系的致命威胁（毕竟 Docker 本身可没提供完善的用户权限管理）。<a class=link href=https://docs.docker.com/engine/install/linux-postinstall/#manage-docker-as-a-non-root-user target=_blank rel=noopener>Docker 官方文档</a>明确指出：</p><blockquote><p>The <code>docker</code> group grants root-level privileges to the user.</p></blockquote><p>所以本题需要解决的问题就是：作为 docker 用户组内的用户，如何获取等同于 Root 用户的权限。找到了一个<a class=link href=https://gist.github.com/nileshsimaria/82ed9eaf116832a8d7128ecb08dddc11 target=_blank rel=noopener>简单的教程</a>，由于题目提到 /flag 是软链接，所以先 <code>ls -l /flag</code> 查看具体情况，果不其然是 Root 用户才能读取的文件，链接到 /dev/shm/flag，所以执行以下操作就能拿到 flag：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>docker run -it --rm -v /:/host alpine
</span></span><span class=line><span class=cl>cat /host/dev/shm/flag
</span></span></code></pre></div><h1 id=惜字如金-20>惜字如金 2.0</h1><p>难得解决了一道 math 题，做完以后发现只需要仔细观察即可解决，并不需要什么密码学知识。分析过程可能有些长，实际上我写起来都有点累，不感兴趣的读者直接跳过即可。</p><p>查看代码，发现其核心逻辑就是按给定的索引从密码本中取出字符并打印，但这个密码本被惜字如金处理了，需要设法还原。首先查看密码本所在的 get_cod_dict 函数，从 <code>check_equals(set(len(s) for s in cod_dict), {24})</code> 可以看出 cod_dict 内每个列表的字符串长度都应当是 24，另外肉眼可以看出经过惜字如金处理后函数里多次添加的列表长度都是一样的（记得用等宽字体），统计出来的长度都是 23，说明惜字如金处理把每个列表里的一位字符给删掉了。得知这些信息后我差点就想仿照去年的惜字如金题解那样开始暴力破解还原数据了，但是看到 <code>check_equals(flag.index('flag{'), 0)</code> 等代码后觉得可以通过这些判断条件排除一些选项节约暴破时间。</p><p>首先我们知道最后得到的 flag 应当以 flag{ 作为开头，} 作为结束，那么先从 f 开始，对应的索引值为 53，那么说明第三个列表的第六个字符应当是 f，但实际的列表第六位是 5，前一位才是 f，说明这里的 f 被删掉了，直接还原一个列表；接着是 l，对应 41，说明第二个列表的第十八个字符应当是 l，实际也没错，那么说明 l 之后有一个字符被删掉了；a 对应 85，说明第四个列表的第十四个字符应当是 a，实际也确实如此，但前一个字符也是 a，没法得知到底是 a 之前还是之后的字符被删掉了；g 对应 109，说明第五个列表的第十四个字符应当是 g，实际对应位置的却是 u，g 在前一位，说明 g 之前有一个字符被删掉了；接着是 {，对应 75，说明第四个列表的第四个字符应当是 {，实际上是 l，{ 在前一位，由此我们终于知道第四个列表是 { 之前的 c 或 t 被惜字如金删掉了；最后是 }，对应 28，在第二个列表，由于其在第十八个字符（l）之前，所以没有告诉我们新的信息。</p><p>整合以上信息后得到以下列表（用空格分隔已知与未知哪里被删掉的部分）：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=n>cod_dict</span> <span class=o>+=</span> <span class=p>[</span><span class=s1>&#39;nymeh1niwemflcir}echaet &#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>cod_dict</span> <span class=o>+=</span> <span class=p>[</span><span class=s1>&#39;a3g7}kidgojernoetl sup?h&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>cod_dict</span> <span class=o>+=</span> <span class=p>[</span><span class=s1>&#39;ulw!ff5soadrhwnrsnstnoeq&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>cod_dict</span> <span class=o>+=</span> <span class=p>[</span><span class=s1>&#39;ct {l-findiehaai{oveatas&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>cod_dict</span> <span class=o>+=</span> <span class=p>[</span><span class=s1>&#39;ty9kxborszst guyd?!blm-p&#39;</span><span class=p>]</span>
</span></span></code></pre></div><p>接下来是否要尝试还原未知的字符呢，我们尝试看一下需要用到的索引是否存在于未知哪里被删掉的部分（第一个列表除外）：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=k>def</span> <span class=nf>check</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=p>[</span><span class=mi>53</span><span class=p>,</span> <span class=mi>41</span><span class=p>,</span> <span class=mi>85</span><span class=p>,</span> <span class=mi>109</span><span class=p>,</span> <span class=mi>75</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>33</span><span class=p>,</span> <span class=mi>48</span><span class=p>,</span> <span class=mi>77</span><span class=p>,</span> <span class=mi>90</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=mi>17</span><span class=p>,</span> <span class=mi>118</span><span class=p>,</span> <span class=mi>36</span><span class=p>,</span> <span class=mi>25</span><span class=p>,</span> <span class=mi>13</span><span class=p>,</span> <span class=mi>89</span><span class=p>,</span> <span class=mi>90</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>63</span><span class=p>,</span> <span class=mi>25</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=mi>31</span><span class=p>,</span> <span class=mi>77</span><span class=p>,</span> <span class=mi>27</span><span class=p>,</span> <span class=mi>60</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>118</span><span class=p>,</span> <span class=mi>24</span><span class=p>,</span> <span class=mi>62</span><span class=p>,</span> <span class=mi>54</span><span class=p>,</span> <span class=mi>61</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=mi>25</span><span class=p>,</span> <span class=mi>63</span><span class=p>,</span> <span class=mi>77</span><span class=p>,</span> <span class=mi>36</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>32</span><span class=p>,</span> <span class=mi>60</span><span class=p>,</span> <span class=mi>67</span><span class=p>,</span> <span class=mi>113</span><span class=p>,</span> <span class=mi>28</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=o>+</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>check</span><span class=p>(</span><span class=mi>42</span><span class=p>,</span> <span class=mi>47</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>check</span><span class=p>(</span><span class=mi>72</span><span class=p>,</span> <span class=mi>74</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>check</span><span class=p>(</span><span class=mi>96</span><span class=p>,</span> <span class=mi>108</span><span class=p>)</span>
</span></span></code></pre></div><p>看上去给出的索引都刚好没有落在未知哪里被删掉的部分（第一个列表未知），据此还原密码本并修正语法错误后试试打印 flag，提交后发现答案正确，本题解决。最后附上<a class=link href=https://gist.github.com/vifly/406b6ad86a4f725b14a6494dff1755c3#file-xzrj_print_flag-py target=_blank rel=noopener>我还原出来的代码</a>，直接运行即可获取 flag。</p><h1 id=-高频率星球>🪐 高频率星球</h1><p>本题没什么难度，就是解题过程实在让我有点提不起劲。用 <code>asciinema play asciinema_restore.rec</code> 可以看到 flag.js 的内容被打印出来，如果直接把打印的内容重定向到文件里就会发现其中有很多的转义字符，这里我直接<a class=link href=https://gist.github.com/vifly/406b6ad86a4f725b14a6494dff1755c3#file-player-py target=_blank rel=noopener>修改 asciinema 对应的代码</a>令其先清除一部分转义字符再将内容保存到 rec.js 中，修改代码后运行 <code>asciinema play asciinema_restore.rec</code> 得到 rec.js，然后根据 <code>node rec.js</code> 的报错信息修改 rec.js，直到它能正确打印 flag 为止。</p><h1 id=-小型大语言模型星球>🪐 小型大语言模型星球</h1><p>如何通过提示词操控语言模型输出特定的回答是目前安全领域的热门方向，Hackergame 今年也顺应潮流新增了这道涉及语言模型的 AI 题。作为炼丹师看到这道题目也是一下就起劲了，只不过试了一下提示词后才发现使用的语言模型不是像 ChatGPT 这样用于聊天任务的模型，而是专门用于补全任务，即根据给定的提示词（或者说上文），生成有关联的下文。这导致原本用于 LLM 的经典提示词都没法使用了，所以第一小题我用一个取巧的方法解决了，至于剩下的小题，理论上可以训练一个生成对抗网络（GAN）来找到能让语言模型输出特定词语的提示词，但由于实在没空遂放弃。</p><h2 id=you-are-smart>You Are Smart</h2><p>翻看 <a class=link href=https://arxiv.org/pdf/2305.07759.pdf target=_blank rel=noopener>TinyStories 对应的论文</a>，发现其是用 LLM 生成了一批数据后用于训练一个小型语言模型，既然是用梯度下降法训练的，那么模型肯定会在相当程度上拟合训练集，下载接近 2G 的<a class=link href=https://huggingface.co/datasets/roneneldan/TinyStories/blob/main/TinyStories-train.txt target=_blank rel=noopener>训练集</a>到本地，然后 <code>rg "you are smart" TinyStories-train.txt</code> 找到含有所需输出的句子，挑了一句的前半部分作为提示词输入模型（我选的是“You are not silly,”，在第 3738500 行出现），成功让其输出含有“you are smart”的句子就解决了。</p><h1 id=为什么要打开-flag->为什么要打开 /flag 😡</h1><h2 id=ld_preload>LD_PRELOAD</h2><p>对于在 Linux 上给 CLI 应用设置过代理的人来说，proxychains 是大概率用过的软件，其原理就是通过 LD_PRELOAD 这个环境变量劫持应用所用到的动态链接库，让其使用经过魔改遵循 proxychains 代理设置的用于网络通信的函数。当我们的 fopen 被同样的方式劫持后该如何打开想要的文件呢，很简单，参考给 C 语言软件实现插件系统的做法，在运行时加载正确的 glibc 即可，毕竟 LD_PRELOAD 只能影响初始化时的行为，但运行时加载就无能为力了。</p><p>所用到的代码在<a class=link href=https://gist.github.com/vifly/406b6ad86a4f725b14a6494dff1755c3#file-read_real_flag-c target=_blank rel=noopener>这</a>，需要注意的就是服务端的 decode 没做异常处理，所以 printf 时做了一点过滤以防止出现无法解码的内容，在本地的 Debian 12 环境中编译好后上传即可。</p><h1 id=总结>总结</h1><p>由于题目量增多，今年可以说是在马不停蹄地尝试解题，在不同的待解题目之间来回切换。最开心的当然是解决了 math 第一题与 binary 的第一小题，几次参赛的经历让我发现自己遇到汇编题基本都没辙，没法让自己的思维和二进制的数据亲密贴贴（笑），但今年不需要解析汇编代码的 LD_PRELOAD 题还是没问题的嘛。希望明年的 Hackergame 能继续玩梗，多来点有趣的题目。</p></section><footer class=article-footer><section class=article-tags><a href=/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/>信息安全</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-contents--wrapper><h2 class=section-title>Related contents</h2><div class=related-contents><div class="flex article-list--tile"><article class=has-image><a href=/Hackergame_2022_writeups/><div class=article-image><img src=/Hackergame_2022_writeups/show.1bf2cbb7d935f5fe193a14cdcaaab42c_hu93f117fa8a9f2091bb1e93e4a16b32af_325315_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy alt="Featured image of post 2022 中科大信息安全大赛题解" data-hash="md5-G/LLt9k19f4ZOhTNyqq0LA=="></div><div class=article-details><h2 class=article-title>2022 中科大信息安全大赛题解</h2></div></a></article><article class=has-image><a href=/Hackergame_2021_writeups/><div class=article-image><img src=/Hackergame_2021_writeups/show.02a042ed813f37a77d72aef0074d5c68_hued1753f52dabbdb4ad30a094c50ac508_1372538_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy alt="Featured image of post 2021 中科大信息安全大赛题解" data-hash="md5-AqBC7YE/N6d9cq7wB01caA=="></div><div class=article-details><h2 class=article-title>2021 中科大信息安全大赛题解</h2></div></a></article><article class=has-image><a href=/Hackergame_2020_writeups/><div class=article-image><img src=/Hackergame_2020_writeups/show.961f9901878e2b82abaaeb7e1f326343_hu047d013128609b76bc4f6f1998ad3a88_1069728_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy alt="Featured image of post 中科大信息安全大赛初体验" data-hash="md5-lh+ZAYeOK4Krqut+HzJjQw=="></div><div class=article-details><h2 class=article-title>中科大信息安全大赛初体验</h2></div></a></article><article class=has-image><a href=/translate_elliptic_curve_cryptography_explained/><div class=article-image><img src=/translate_elliptic_curve_cryptography_explained/show.8ac351075994593ec66b34bae84b47b5_hu5601238948948f72ac070df8361310aa_232702_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy alt="Featured image of post 【译】椭圆曲线密码介绍" data-hash="md5-isNRB1mUWT7GazS66EtHtQ=="></div><div class=article-details><h2 class=article-title>【译】椭圆曲线密码介绍</h2></div></a></article></div></div></aside><div id=isso-comment><script data-isso=https://comments.viflythink.com/isso/ data-isso-css=true data-isso-lang=zh_CN data-isso-reply-to-self=true data-isso-require-author=true data-isso-require-email=false data-isso-max-comments-top=10 data-isso-max-comments-nested=5 data-isso-reveal-on-click=5 data-isso-avatar=true data-isso-vote=true data-isso-vote-levels data-isso-feed=false src=https://comments.viflythink.com/isso/js/embed.min.js></script><section id=isso-thread></section></div><style>#isso-comment{background-color:#eee;padding:2pc}</style><footer class=site-footer><section class=copyright>&copy;
2019 -
2023 Vifly 的博客</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.11.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://viflythink.com/js/photoswipe.min.js crossorigin=anonymous defer></script><script src=https://viflythink.com/js/photoswipe-ui-default.min.js crossorigin=anonymous defer></script><link rel=stylesheet href=https://viflythink.com/css/default-skin.css crossorigin=anonymous><link rel=stylesheet href=https://viflythink.com/css/photoswipe.css crossorigin=anonymous></main><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#hackergame-启动>Hackergame 启动</a></li><li><a href=#猫咪小测>猫咪小测</a></li><li><a href=#更深更暗>更深更暗</a></li><li><a href=#旅行照片-30>旅行照片 3.0</a><ol><li><a href=#题目-1-2>题目 1-2</a></li><li><a href=#题目-3-4>题目 3-4</a></li></ol></li><li><a href=#赛博井字棋>赛博井字棋</a></li><li><a href=#奶奶的睡前-flag-故事>奶奶的睡前 flag 故事</a></li><li><a href=#组委会模拟器>组委会模拟器</a></li><li><a href=#虫>虫</a></li><li><a href=#json--yaml>JSON ⊂ YAML?</a><ol><li><a href=#json--yaml-11>JSON ⊄ YAML 1.1</a></li></ol></li><li><a href=#git-git>Git? Git!</a></li><li><a href=#http-集邮册>HTTP 集邮册</a><ol><li><a href=#5-种状态码>5 种状态码</a></li></ol></li><li><a href=#docker-for-everyone>Docker for Everyone</a></li><li><a href=#惜字如金-20>惜字如金 2.0</a></li><li><a href=#-高频率星球>🪐 高频率星球</a></li><li><a href=#-小型大语言模型星球>🪐 小型大语言模型星球</a><ol><li><a href=#you-are-smart>You Are Smart</a></li></ol></li><li><a href=#为什么要打开-flag->为什么要打开 /flag 😡</a><ol><li><a href=#ld_preload>LD_PRELOAD</a></li></ol></li><li><a href=#总结>总结</a></li></ol></nav></div></section></aside></div><script src=https://viflythink.com/js/vibrant.min.js crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>