<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="在新电脑上的 Arch 安装随手记，以及一点新的软件安利"><title>我的新 Arch</title><link rel=canonical href=https://viflythink.com/New-Install-Arch/><link rel=stylesheet href=/scss/style.min.450926226e724574a6b936335ea06111f8aeb253d932c86cb2cc807341cd2889.css><meta property="og:title" content="我的新 Arch"><meta property="og:description" content="在新电脑上的 Arch 安装随手记，以及一点新的软件安利"><meta property="og:url" content="https://viflythink.com/New-Install-Arch/"><meta property="og:site_name" content="Vifly 的博客"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="折腾"><meta property="article:tag" content="Linux"><meta property="article:tag" content="软件安利"><meta property="article:published_time" content="2023-08-08T00:00:00+08:00"><meta property="article:modified_time" content="2023-08-08T00:00:00+08:00"><meta property="og:image" content="https://viflythink.com/New-Install-Arch/show.jpg"><meta name=twitter:title content="我的新 Arch"><meta name=twitter:description content="在新电脑上的 Arch 安装随手记，以及一点新的软件安利"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://viflythink.com/New-Install-Arch/show.jpg"><link rel="shortcut icon" href=img/favicon.png><meta name=google-site-verification content="o-widUnxdyv8T6wPC_NGLfDgKUwgv2-zMnQhKLKul3Y"><meta name=msvalidate.01 content="D8C8D2BAD9DA419D96DA79455FC4DDBC"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu139cde8ab2a45f6f8ca9b1d680d35535_828870_300x0_resize_box_3.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Vifly 的博客</a></h1><script>fetch("https://api.github.com/gists/7a04e2188185ddb19cbd19d8217b9400").then(e=>{if(e.ok)return e.json();throw new Error("Unable to fetch gist slogans.")}).then(e=>JSON.parse(e.files["slogans.json"].content)).then(e=>e[Math.floor(Math.random()*e.length)].content).then(e=>{document.getElementById("slogan").innerHTML="<h2 id='slogan' class='site-description'>"+e+"</h2>"})</script><h2 id=slogan class=site-description></h2></div></header><ol class=social-menu><li><a href=mailto:viflythink@gmail.com target=_blank title=Email><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-mail" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="3" y="5" width="18" height="14" rx="2"/><polyline points="3 7 12 13 21 7"/></svg></a></li><li><a href=https://github.com/vifly target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://viflythink.com/atom.xml target=_blank title=RSS><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></a></li><li><a href=https://t.me/viflythink target=_blank title=Telegram><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-telegram" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M15 10l-4 4 6 6 4-16-18 7 4 2 2 6 3-4"/></svg></a></li><li><a href=https://twitter.com/viflythink target=_blank title=Twitter><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/ target=_blank><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/tags/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-tag" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11 3l9 9a1.5 1.5.0 010 2l-6 6a1.5 1.5.0 01-2 0L3 11V7a4 4 0 014-4h4"/><circle cx="9" cy="9" r="2"/></svg><span>Tags</span></a></li><li><a href=/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>About</span></a></li><li><a href=/links/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg><span>Links</span></a></li><li><a href=/service/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-cloud" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 18a4.6 4.4.0 010-9 5 4.5.0 0111 2h1a3.5 3.5.0 010 7H7"/></svg><span>Service</span></a></li><li><a href=/gpg/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-key" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="8" cy="15" r="4"/><line x1="10.85" y1="12.15" x2="19" y2="4"/><line x1="18" y1="5" x2="20" y2="7"/><line x1="15" y1="8" x2="17" y2="10"/></svg><span>GPG key</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/New-Install-Arch/><img src=/New-Install-Arch/show_hu7bd73b4587a1fedfeeaaaaec8e8e7475_223420_800x0_resize_q75_box.jpg srcset="/New-Install-Arch/show_hu7bd73b4587a1fedfeeaaaaec8e8e7475_223420_800x0_resize_q75_box.jpg 800w, /New-Install-Arch/show_hu7bd73b4587a1fedfeeaaaaec8e8e7475_223420_1600x0_resize_q75_box.jpg 1600w" width=800 height=450 loading=lazy alt="Featured image of post 我的新 Arch"></a></div><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/New-Install-Arch/>我的新 Arch</a></h2><h3 class=article-subtitle>在新电脑上的 Arch 安装随手记，以及一点新的软件安利</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>2023 年 08 月 08 日</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>9 minute read</time></div></footer></div></header><section class=article-content><p>前段时间存储相关的元件价格大跳水，博主终于等到了这个时机给自己组装了一台期待已久的台式机。不得不说今年的 PC 组件价格十分魔幻，SSD 甚至能比 HDD 便宜，于是我的台式机只配备了 SSD，另外基于不打算给老黄送钱的心理，也暂时没配置独显，以上使得自己的组装工作避免了一大堆麻烦，不用给 HDD 接 SATA 线，也不用给独显接电源线，整个装机过程非常的轻松愉快。在电脑能开机后，接下来当然是给它装上熟悉的 Arch Linux 用来日常工作与娱乐。尽管在之前的<a class=link href=https://viflythink.com/Try_Arch_Linux/ target=_blank rel=noopener>从 Debian 迁移到 Arch Linux</a> 一文已经说过了我是如何安装 Arch 的，然后还安利了一部分软件，但时过境迁，由于自己能力的进步与发现了更好的软件，这回也折腾了一些之前没试过的新玩意，所以本文既是新安装 Arch 的随手记录，也是对旧文的一个更新，推荐与上面的旧文对比阅读。</p><h1 id=安装基本系统>安装基本系统</h1><p>与之前相比，这次安装 Arch 就大胆地实验了一些没尝试过的新玩意。之前完全按教程配置双系统时使用了 GRUB 作为引导加载程序（boot loader），而由于这次不打算在电脑上安装 Windows，所以用 systemd-boot 取而代之。然后也使用了 Btrfs 作为我的新 Arch 的根文件系统（具体原因见下文），当然，还要加上 LUKS 全盘加密，为了方便硬盘解密，还要配置 <a class=link href=https://0pointer.net/blog/unlocking-luks2-volumes-with-tpm2-fido2-pkcs11-security-hardware-on-systemd-248.html target=_blank rel=noopener>systemd 248 版本新增的 systemd-cryptenroll</a> 让我能用 YubiKey 开机自动解密硬盘，避免输入一长串密码。以上组合使得我能参考的资料极其有限，仅仅 systemd-boot + Btrfs 的话看 Arch Wiki 足矣，但加上全盘加密后事情就变得相当复杂，<a class=link href=https://wiki.archlinux.org/title/Dm-crypt/Encrypting_an_entire_system#Btrfs_subvolumes_with_swap target=_blank rel=noopener>Arch Wiki 上的 Btrfs + LUKS 示例</a>是假设用户也加密 /boot 的（须 EFI 与 boot 分区不同），仅仅不加密 EFI，所以只能用 GRUB，而我的分区规划是把 EFI 分区挂载到 /boot（即两者为同一个东西），且我的威胁模型中也没有那么高级的攻击者，因此我不打算加密 /boot。不同的情况导致我不得不另外查找资料，所幸的是还能找到一篇 <a class=link href=https://nerdstuff.org/posts/2020/2020-004_arch_linux_luks_btrfs_systemd-boot/ target=_blank rel=noopener>Installing Arch Linux with Btrfs, systemd-boot and LUKS</a>。根据这篇文章与 Arch Wiki 安装好了新系统，完成后确认可以通过密码解锁硬盘，然后还得研究如何使用 systemd-cryptenroll。按上面的文章配置是肯定不行的，initramfs 里都没有 systemd，开机根本就不会检测 YubiKey。为此我找到了一篇跟自己的需求较为相似的 <a class=link href=https://lemmy.eus/post/2898 target=_blank rel=noopener>Setting up Arch + LUKS + BTRFS + systemd-boot + apparmor + Secure Boot + TPM 2.0</a>，尽管我不打算像这篇文章一样配置安全启动与 TPM 以自动解锁硬盘，但我们都是使用 systemd-cryptenroll 的，按照其中的思路修改一下配置，转而使用 YubiKey 是没问题的。systemd-cryptenroll 支持的设备类型非常广泛，FIDO 2、TPM 2 与 PKCS#11 都可以，而 YubiKey 则能充当以上除了 TPM 外的其它安全设备（除了贵以外没什么缺点），这里我把 YubiKey 当作 FIDO 2 设备使用。经过折腾，最终确认 /etc/mkinitcpio.conf 应该包含以下内容（应该还可以删减一些 Hook，懒得试了）：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl><span class=nv>HOOKS</span><span class=o>=(</span>base udev systemd autodetect modconf kms keyboard sd-vconsole block sd-encrypt btrfs filesystems fsck<span class=o>)</span>
</span></span></code></pre></div><p>/boot/loader/entries/arch.conf 则应该是（假设使用 linux 内核）：</p><pre tabindex=0><code>title Arch Linux
linux /vmlinuz-linux
initrd /initramfs-linux.img
options rd.luks.name=&lt;Your-UUID&gt;=luks root=/dev/mapper/luks rootflags=subvol=@ rd.luks.options=&lt;Your-UUID&gt;=fido2-device=auto,discard rw
</code></pre><p>这里提醒一下想照抄作业的读者，我并没有加密 /boot，没有启用安全启动，且在挂载加密盘时允许 discard，这都会降低安全性，如果对此比较在意请选择别的方案。</p><h2 id=为什么选择-btrfs>为什么选择 Btrfs</h2><p>此前我一直在用经典的 Ext4 作为使用 Linux 时的文件系统，但这么多年过去了，以下几点令我开始认真地考虑尝试使用 Btrfs：</p><ol><li>Btrfs 可以说已是成熟状态，<a class=link href=https://btrfs.readthedocs.io/en/latest/Status.html target=_blank rel=noopener>绝大部分功能已经稳定</a>，<a class=link href=https://www.linux.com/news/how-facebook-uses-linux-and-btrfs-interview-chris-mason/ target=_blank rel=noopener>Facebook 也在生产环境中使用 Btrfs</a>。</li><li>从 Ext4 迁移到 Btrfs 没有太多的痛苦（前提是不使用问题较多的 btrfs-convert 原地替换 Ext4，所以在新系统上使用是最简单的），基本不需要多少额外的配置，只要理解 Btrfs 的子卷怎么挂载就行，而常见的数据库与容器应用都会自动创建 Btrfs 的子卷，用户确实不需要怎么操心。</li><li>数据安全性更有保障，默认采用 CoW（Copy on Write），带有 checksum 等措施使得意外丢失数据的可能性大大降低。当然，这并不能完全杜绝断电丢失最新写入数据的情况，因为数据的可靠保存不仅需要底层的支持，还需要上层应用的额外关注。另外，checksum 的存在使得文件的任何损坏都可以被及时发现，即使你的硬盘里的内容翻转了一比特都能被检测出来，避免了静默错误的出现（至于如何处理损坏的内容则是另一回事了）。</li><li>还有一堆现代的特性，例如<a class=link href=https://wiki.archlinux.org/title/Btrfs#Compression target=_blank rel=noopener>透明压缩</a>，这个基本上每个人都会用到；快照，每次更新系统或折腾容易玩崩的东西前先拍个快照，方便一键还原；增量备份，通过<a class=link href=https://wiki.archlinux.org/title/Btrfs#Send/receive target=_blank rel=noopener>对子卷的 send/receive</a>，可以轻松地把子卷增量备份到另一个使用 Btrfs 的硬盘中。除此以外还有一些我暂时用不到的特性与功能，如 RAID、容量配额等等，具体可在 <a class=link href=https://wiki.archlinux.org/title/Btrfs target=_blank rel=noopener>Arch Wiki</a> 中查看。</li></ol><p>当然，Btrfs 目前也还没到能受到所有人的欢迎的程度：它的读写速度要慢于 Ext4（CoW 的通病），而一旦检测到 checksum 出错则会强制要求用户进行处理也令有些人感到不爽。对于我来说，比较不满的一点是其本身没有加密功能，必须要与 LUKS 之类的方案一起使用才能达成全盘加密，希望未来能有更好的解决方案。</p><h1 id=日常使用>日常使用</h1><h2 id=kde>KDE</h2><p>我在之前已经吐槽过安装 kde-applications 包组后会有一堆用不到的软件，甚至还写了一个<a class=link href=https://gist.github.com/vifly/33d1a4f63b0b7319c6db9af9d3bdbdb0 target=_blank rel=noopener>简单的 Python 脚本</a>来删除它们。现在我发现更好的解决方法应该是在安装时就对此进行处理，根据我的需求这里给各位推荐一个安装 KDE 的方案。首先不要按 <a class=link href=https://wiki.archlinux.org/title/KDE#Plasma target=_blank rel=noopener>Arch Wiki</a> 上说的先安装 Xorg，直接安装 <a class=link href=https://archlinux.org/groups/x86_64/plasma/ target=_blank rel=noopener>plasma 包组</a>即可，其中的依赖关系会导致 plasma 所需的 Xorg 组件也被安装，如果你需要使用 Wayland 的话请再安装 plasma-wayland-session 包。另外，安装包组有一个好处，那就是可以排除自己不想安装的软件包，例如我就排除了：</p><pre tabindex=0><code>discover
milou
oxygen
oxygen-sounds
plasma-sdk
plasma-vault
plasma-workspace-wallpapers
</code></pre><p>经过以上操作后已经装好了基础的桌面环境，但我们还需要配套的应用，而如果直接安装 kde-applications-meta 的话会装上一堆用不到的软件和游戏，选择 kde-applications 包组的话需要手动排除的项目也不少，更好的办法是根据 <a class=link href=https://gitlab.archlinux.org/archlinux/packaging/packages/kde-applications-meta/-/blob/main/PKGBUILD target=_blank rel=noopener>kde-applications-meta 的 PKGBUILD</a> 创建一个属于自己的 kde-applications-meta。这里给出我日常使用软件所构成的 <a class=link href=https://gist.github.com/vifly/253e3184f5a1d87c1292b131cba1c09c target=_blank rel=noopener>meta 包</a>，下载该 PKGBUILD 后在文件所处的目录下执行 <code>makepkg -si</code> 即可。<em>PS：如果你仔细查看该 PKGBUILD 就会发现里面没有包含 KDE 家的图片浏览器 gwenview，原因是我使用 nomacs 作为日常的图片浏览器。</em></p><h2 id=美化>美化</h2><p>在我刚开始使用 KDE 后没多久就写过一篇<a class=link href=https://viflythink.com/KDE_to_Windows10/ target=_blank rel=noopener> KDE 的美化教程</a>，探索了将 KDE 的外观变成 Windows 10 的可能性。经过了几年，由于 KDE 的版本更新导致部分选项有所改变，且我找到了一些更好的美化方案，所以抽空大改了一波上面的博文，想要美化自己的 KDE 桌面的童鞋继续查看该博文即可。</p><h2 id=steam>Steam</h2><p>就日常娱乐来说，Steam 当然是一个好选择，感谢 V 社一直以来对 Linux 游戏的支持（特别是其开发的 Proton 极大地扩充了 Linux 下可游玩的游戏范围），现在 Linux 下大部分游戏的体验已经不亚于 Windows，只需要打开 Steam 一键安装就能开玩。不过对于一个强迫症来说，Steam 及其安装的游戏在家目录下乱扔垃圾这点还是令我挺不爽的。之前我一直在用 <a class=link href=https://liolok.com/zhs/containerize-steam-with-systemd-nspawn/ target=_blank rel=noopener>systemd-nspawn</a> 隔离相关应用，但后来发现为此专门准备一个容器所占的空间太大了点，而且隔离级别较高还要解决一些游戏的运行问题，于是在新系统上决定尝试改用 Flatpak 作为安装与使用 Steam 的方式（虽然 Flatpak 会创建 ~/.var 这个目录）。首先根据 <a class=link href=https://wiki.archlinux.org/title/steam#Flatpak target=_blank rel=noopener>Arch Wiki</a> 先安装 Steam 本体，再加上一些个人使用的配套应用：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>flatpak install flathub com.valvesoftware.Steam com.valvesoftware.Steam.Utility.protontricks com.valvesoftware.SteamLink
</span></span></code></pre></div><p>然后直接在开始菜单找到并启动 Steam 看看效果，基本上与在本机系统内直接安装 steam 没什么区别。如果中文字体不对劲，安装 ttf-liberation 应该能解决。</p><p>如果你使用 KDE 且安装了 flatpak-kcm 这个包，此时便可以在系统设置中的“应用程序”->“Flatpak 权限设置”中对安装的 Flatpak 应用进行管理，比如设置更细分的权限与应用运行时的环境变量等等。举个例子，这里我就给 Steam 创建了一个新的 Btrfs 子卷（挂载到 /games）用于安装游戏：</p><p><img src=/New-Install-Arch/set_flatpak_steam_fs_access.png width=1466 height=1026 loading=lazy alt=set_flatpak_steam_fs_access class=gallery-image data-flex-grow=142 data-flex-basis=342px></p><p>除此以外，如果你因没有配置透明代理而在使用 Steam 时撞到墙，那么可以通过修改 desktop 文件让 Steam 使用代理。具体做法是，先执行 <code>cp /var/lib/flatpak/exports/share/applications/com.valvesoftware.Steam.desktop ~/.local/share/applications/</code> 把 Steam 的 desktop 文件复制到用户目录下，然后开始修改对应复制过来的文件，在 &ldquo;Actions=&rdquo; 开头的一行把 &ldquo;RunWithProxy;&rdquo; 添加到该行末尾，然后在文件的末尾添加以下内容：</p><pre tabindex=0><code>[Desktop Action RunWithProxy]
Name=Run with proxy
Name[zh_CN]=使用代理运行
Name[zh_TW]=使用代理運行
Exec=/usr/bin/flatpak run --branch=stable --arch=x86_64 --command=/app/bin/steam-wrapper --file-forwarding --env=https_proxy=http://127.0.0.1:1090 com.valvesoftware.Steam -tcp @@u %U @@
</code></pre><p>以上的 Exec 就是在原来的默认值上加了两个参数，让 Steam 使用 TCP 连接，以遵循新增的 https_proxy 环境变量，记得把 https_proxy 修改为自己的 HTTP 代理地址与端口号，这里提供一下<a class=link href=https://gist.github.com/vifly/ccdfd05899263e43ed269bbca8ec40f4 target=_blank rel=noopener>我修改后的文件</a>以供参考。保存好文件后将其链接到 ~/Desktop 下，在需要让 Steam 翻墙时，只需右键点击桌面上的 Steam 图标然后选择“使用代理运行”即可。</p><p><img src=/New-Install-Arch/run_steam_with_proxy.png width=463 height=766 loading=lazy alt=run_steam_with_proxy class=gallery-image data-flex-grow=60 data-flex-basis=145px></p><h2 id=输入法>输入法</h2><p>目前我已经把输入法方案从 Fcitx4 + RIME 切换到了 Fcitx5 自带的拼音输入法。当年使用 RIME 的主要原因是包括 google pinyin 在内 Fcitx4 自带的拼音输入法的候选词算法都十分糟糕，而现在 fcitx5-chinese-addons 里的拼音输入法已经足够好用，与 RIME 相比，Fcitx5 拼音输入法更开箱即用，候选词算法更优秀，同时在可折腾性上也不输 RIME，支持 Lua 插件、导入第三方词库、输入法皮肤、快速输入 Emoji 与特殊 Unicode 等功能。所以除非有什么非常需要的 RIME 独占功能，否则我都一律推荐使用 Fcitx5 拼音输入法。</p><p>只需根据 <a class=link href=https://wiki.archlinuxcn.org/wiki/Fcitx5 target=_blank rel=noopener>Arch Wiki</a> 安装好对应的包组与包后重启即可：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>sudo pacman -S fcitx5-im fcitx5-lua fcitx5-chinese-addons
</span></span></code></pre></div><p>另外，想在 Android 手机上使用 Fcitx5 拼音输入法的童鞋可以尝试 <a class=link href=https://github.com/fcitx5-android/fcitx5-android target=_blank rel=noopener>fcitx5-android</a> 这个项目。目前日常使用所需的功能已全部就位，可以确保在手机上也有与电脑相同的输入体验。</p><h2 id=其它>其它</h2><p>我的音频播放器从 Rhythmbox 切换到了同属 Gnome 家的 Lollypop（KDE 请加油），与 Rhythmbox 相比，Lollypop 的界面更为现代（见下图），还支持自动从互联网下载歌曲封面图片，搜索歌词等功能。</p><p><img src=/New-Install-Arch/Lollypop.png width=1305 height=968 loading=lazy alt=Lollypop class=gallery-image data-flex-grow=134 data-flex-basis=323px></p><p>而笔记工具则令我颇为头疼，考虑到前不久 <a class=link href="https://news.ycombinator.com/item?id=36609641" target=_blank rel=noopener>Evernote 的新母公司裁掉了几乎所有员工</a>的新闻，尽管后来解释称是准备将运营团队转移至欧洲，因而裁掉了原来的员工，但我实际上在 Evernote 被收购时就已经对 Evernote 的前景感到担忧，所以早就想物色一个新的笔记工具了。最近流行的笔记工具都声称自己受到了 <a class=link href=https://zettelkasten.de/introduction/ target=_blank rel=noopener>Zettelkasten</a>（卡片盒）笔记法的启发，设计出了从根基上与 Evernote 这种“传统”笔记不同的结构，例如 Logseq、Obsidian、Notion、Emacs 的 org-roam 等。对于是否迁移到它们之一，或继续坚守“传统”，我目前还在犹豫，欢迎各位读者向我推荐自己喜欢的笔记软件。无论如何，先用 <a class=link href=https://github.com/vzhd1701/evernote-backup target=_blank rel=noopener>evernote-backup</a> 导出笔记后用 <a class=link href=https://github.com/akosbalasko/yarle target=_blank rel=noopener>Yarle</a> 转为 markdown 做好最坏情况下的准备总是没错的，至少目前 Evernote 还保持着一贯的开放 API，使得迁移笔记还没什么问题。</p><p>还有之前没有推荐过的 KDE Connect，它可以实现手机与电脑的互联，例如同步通知、互传文件、多媒体控制、远程执行命令等，强大到足以被称为开源法拉利，而 Gnome 用户也可以使用 <a class=link href=https://extensions.gnome.org/extension/1319/gsconnect/ target=_blank rel=noopener>GSConnect 扩展</a>享受到同样的功能。</p></section><footer class=article-footer><section class=article-tags><a href=/tags/%E6%8A%98%E8%85%BE/>折腾</a>
<a href=/tags/Linux/>Linux</a>
<a href=/tags/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%88%A9/>软件安利</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-contents--wrapper><h2 class=section-title>Related contents</h2><div class=related-contents><div class="flex article-list--tile"><article class=has-image><a href=/Try_Arch_Linux/><div class=article-image><img src=/Try_Arch_Linux/show.92c30b3f3d563c87f51888e113416e36_hubfb0eb0e288deb4ca723092859008c14_673819_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy alt="Featured image of post 从 Debian 迁移到 Arch Linux" data-hash="md5-ksMLPz1WPIf1GIjhE0FuNg=="></div><div class=article-details><h2 class=article-title>从 Debian 迁移到 Arch Linux</h2></div></a></article><article class=has-image><a href=/Use_Vercel_and_OneDrive_to_setup_your_repo/><div class=article-image><img src=/Use_Vercel_and_OneDrive_to_setup_your_repo/show.4727fcbd0f8b4125beaaa4d84d498fb5_hu3a92ba18b985a44b13d2086fb5d2cd73_887024_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy alt="Featured image of post 使用 Vercel 与 OneDrive 自建软件源" data-hash="md5-Ryf8vQ+LQSW+qqTYTUmPtQ=="></div><div class=article-details><h2 class=article-title>使用 Vercel 与 OneDrive 自建软件源</h2></div></a></article><article class=has-image><a href=/Use_GitHubActions_to_build_AUR/><div class=article-image><img src=/Use_GitHubActions_to_build_AUR/show.dade81dbe0ba1ba523070d5a28de0ce8_hu3e4196b515918c37e47fce1bd97e68c0_760288_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post GitHub Actions 打造 AUR 打包下载一条龙服务" data-hash="md5-2t6B2+C6G6UjBw1aKN4M6A=="></div><div class=article-details><h2 class=article-title>GitHub Actions 打造 AUR 打包下载一条龙服务</h2></div></a></article><article class=has-image><a href=/KDE_to_Windows10/><div class=article-image><img src=/KDE_to_Windows10/show.a7fb8d2542e84dd78df8e20e8d6bb395_hua1e96627c79bb7cd39936a6d63fa6003_596890_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy alt="Featured image of post 将 KDE 改造为 Windows 10" data-hash="md5-p/uNJULoTdeN+OIOjWuzlQ=="></div><div class=article-details><h2 class=article-title>将 KDE 改造为 Windows 10</h2></div></a></article><article class=has-image><a href=/Migrate_from_Material_to_Stack/><div class=article-image><img src=/Migrate_from_Material_to_Stack/show.07a70e83032f6bbf812192f7e5116318_hu7d264867c8d78abf58e9b67e98a77df9_254555_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy alt="Featured image of post 从 Material 主题迁移到 Stack 主题" data-hash="md5-B6cOgwMva7+BIZL35RFjGA=="></div><div class=article-details><h2 class=article-title>从 Material 主题迁移到 Stack 主题</h2></div></a></article></div></div></aside><div id=isso-comment><script data-isso=https://comments.viflythink.com/isso/ data-isso-css=true data-isso-lang=zh_CN data-isso-reply-to-self=true data-isso-require-author=true data-isso-require-email=false data-isso-max-comments-top=10 data-isso-max-comments-nested=5 data-isso-reveal-on-click=5 data-isso-avatar=true data-isso-vote=true data-isso-vote-levels data-isso-feed=false src=https://comments.viflythink.com/isso/js/embed.min.js></script><section id=isso-thread></section></div><style>#isso-comment{background-color:#eee;padding:2pc}</style><footer class=site-footer><section class=copyright>&copy;
2019 -
2023 Vifly 的博客</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.11.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://viflythink.com/js/photoswipe.min.js crossorigin=anonymous defer></script><script src=https://viflythink.com/js/photoswipe-ui-default.min.js crossorigin=anonymous defer></script><link rel=stylesheet href=https://viflythink.com/css/default-skin.css crossorigin=anonymous><link rel=stylesheet href=https://viflythink.com/css/photoswipe.css crossorigin=anonymous></main><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#安装基本系统>安装基本系统</a><ol><li><a href=#为什么选择-btrfs>为什么选择 Btrfs</a></li></ol></li><li><a href=#日常使用>日常使用</a><ol><li><a href=#kde>KDE</a></li><li><a href=#美化>美化</a></li><li><a href=#steam>Steam</a></li><li><a href=#输入法>输入法</a></li><li><a href=#其它>其它</a></li></ol></li></ol></nav></div></section></aside></div><script src=https://viflythink.com/js/vibrant.min.js crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>